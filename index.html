<!-- index.html -->
<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lista remontowa</title>
<link rel="stylesheet" href="style.css" />


<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";


const firebaseConfig = {
apiKey: "AIzaSyArKqslVsWLUBO4EOPO6AyOyih23Fy6Y8o",
authDomain: "remont-eryk.firebaseapp.com",
projectId: "remont-eryk",
storageBucket: "remont-eryk.firebasestorage.app",
messagingSenderId: "557601020132",
appId: "1:557601020132:web:8cf6143a11ba33ca8d74f1"
};


const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const itemsRef = collection(db, "items");


const listEl = document.getElementById("list");
const totalEl = document.getElementById("total");
const form = document.getElementById("addForm");


function render(snapshot) {
listEl.innerHTML = "";
let total = 0;


snapshot.forEach(docSnap => {
const d = docSnap.data();
const enabled = d.enabled !== false;
if (enabled) total += d.price * d.qty;


const el = document.createElement("div");
el.className = "item";
el.innerHTML = `
<div class="check">
<input type="checkbox" ${enabled ? "checked" : ""} />
</div>
<img src="${d.image}" />
<div class="content">
<h3>${d.name}</h3>
<details><summary>Opis</summary>${d.desc}</details>
<p>Cena: ${d.price} zł × ${d.qty}</p>
<a href="${d.link}" target="_blank">Sklep</a>
<button class="menu">⋮</button>
</div>
`;


el.querySelector("input").onchange = e => {
updateDoc(doc(db, "items", docSnap.id), { enabled: e.target.checked });
};


el.querySelector(".menu").onclick = () => {
const pin = prompt("PIN:");
if (pin !== "1337") return;
if (confirm("Usunąć pozycję?")) deleteDoc(doc(db, "items", docSnap.id));
};


listEl.appendChild(el);
});


totalEl.textContent = total.toFixed(2) + " zł";
}


onSnapshot(itemsRef, render);


form.onsubmit = async e => {
e.preventDefault();
if (form.pin.value !== "1337") return alert("Zły PIN");


await addDoc(itemsRef, {
name: form.name.value,
desc: form.desc.value,
</html>
